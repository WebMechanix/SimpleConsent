<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SimpleConsent Example</title>

<!-- Google Tag Manager -->
<script>
dataLayer = window.dataLayer || [];
// (function(w,d,s,l,i){
  
//   w[l]=w[l]||[];
//   w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});

//   var f=d.getElementsByTagName(s)[0],
//       j=d.createElement(s),
//       dl=l!='dataLayer'?'&l='+l:'';

//   j.async=true;
//   j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
//   f.parentNode.insertBefore(j,f);
  
// })(window,document,'script','dataLayer','GTM-PTLD5H79');
</script>

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🛠️</text></svg>">
<link rel="preconnect" href="https://fonts.bunny.net">

<!-- Styles -->

<link rel="stylesheet" can-disable href="https://fonts.bunny.net/css?family=fira-code:400,500|saira:400,400i,500,500i,600,600i,700,700i">
<link rel="stylesheet" can-disable href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
<link rel="stylesheet" can-disable href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

<link rel="stylesheet" href="assets/example.css">

<link href="../dist/SimpleConsent.css" rel="stylesheet">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-xonokai.min.css" integrity="sha512-WMvUL/ap3JTqQEo4CIbB0jR2ACx+Qxg78UdKIWzV31CrefYZGtxuSod8uJwWDyzeVpQ0vKnXA41vS4UEvlNkoQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<!-- Scripts -->
<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
<script src="assets/example.js"></script>

<script defer src="./configs/l10n.js"></script>
<script defer src="./configs/ccpa.js"></script>
<script defer src="./configs/gdpr.js"></script>
<script defer src="../dist/SimpleConsent.js"></script>
</head>
<body class="d-flex flex-row align-items-stretch" x-data="{mode: (new URL(location.href).searchParams.get('mode'))}">
  <div x-cloak :class="{ 'd-none': mode == 'simple' }" class="w-50 vh-100 d-flex flex-column align-items-stretch justify-content-stretch border-end border-2 border-dark" style="background: #2a2a2a;">
    <pre class="m-0 h-50 overflow-auto position-relative border-bottom border-2 border-dark" 
      x-data="{label: 'config'}" 
      x-init="$watch('$store.log.config', () => {
        $nextTick(() => {
          Prism.highlightElement($el.querySelector('code'));
        });
      })"><div class="position-sticky d-flex justify-content-end top-0"><span class="bg-dark small px-2 py-1 text-light" x-text="label"></span></div><code class="language-json" data-highlight-key="config" x-text="$store.log.json(label)"></code></pre>
    <pre class="m-0 h-50 overflow-auto position-relative" 
      x-data="{label: 'dataLayer'}" 
      x-init="$watch('$store.log.dataLayer', () => {
        $nextTick(() => {
          Prism.highlightElement($el.querySelector('code'));
        });
      })"><div class="position-sticky d-flex justify-content-end top-0"><span class="bg-dark small px-2 py-1 text-light" x-text="label"></span></div><code class="language-json" data-highlight-key="datalayer" x-text="$store.log.json(label)"></code></pre>
  </div>
  <div class="py-5 w-50 mx-auto vh-100 overflow-auto">

    <div class="container px-3">

      <h1 class="h3 text-center fw-bold mb-5">SimpleConsent TestBench 🛠️</h1>

      <form class="d-flex gap-3 align-items-center justify-content-between" method="get" data-testbench-controls>
        <div class="d-flex align-items-stretch gap-2">

          <div class="input-group w-auto">
            <label class="input-group-text" for="config" title="Config"><i class="bi bi-braces"></i></label>
            <select class="form-select flex-shrink-1 flex-grow-0" style="width: 6.75rem" name="config" id="config">
              <option value="_" selected>Default</option>
              <option value="ccpa">CCPA</option>
              <option value="gdpr">GDPR</option>
              <option value="l10n">L10N</option>
            </select>
          </div>

          <div class="input-group w-auto">
            <label class="input-group-text" for="lang" title="Language"><i class="bi bi-translate"></i></label>
            <select class="form-select flex-shrink-1 flex-grow-0 text-center" style="width: 4.25rem" name="lang" id="lang">
              <option value="en" selected>🇬🇧</option>
              <option value="fr">🇫🇷</option>
              <option value="de">🇩🇪</option>
              <option value="es">🇪🇸</option>
            </select>
          </div>

          <div class="input-group" style="width: 11.25rem;">
            <label class="input-group-text" for="container_id" title="Container ID">GTM-</label>
            <input class="form-control" type="text" name="container_id" id="container_id" placeholder="XXXXXXXX">
          </div>

        </div>
        <div class="d-flex gap-2 align-self-stretch">
          <button class="btn btn-secondary btn-icon" type="button" onclick="SimpleConsent.manager().reset(); return false;"><i class="bi bi-arrow-clockwise"></i></button>
          <button class="btn btn-primary btn-icon" type="submit"><i class="bi bi-arrow-left-right"></i></button>
        </div>
      </form>

      <div class="position-relative">
        <hr class="my-5">
        <span class="badge text-bg-secondary fw-semibold text-uppercase rounded-pill position-absolute" style="top: 50%; left: 50%; transform: translate(-50%, -50%);">Tag Log</span>
      </div>
      
      <div 
        x-data="{ 
          get tags() { 
            return $store.log.tags 
          },
          pulsingTags: new Set(),
          pulse() {
            this.pulsingTags = new Set($store.log.updatedTags);
            setTimeout(() => {
              this.pulsingTags.clear();
              $store.log.clearUpdatedTags();
            }, 1000);
          }
        }"
        x-effect="$store.log.updatedTags.size > 0 && pulse()">

        <template x-for="(tag, index) in $store.log.tags" :key="index" x-cloak>
          <div :data-tag-id="tag.id" :data-tag-key="tag.key" :class="{ 'pulse': pulsingTags.has(tag.key) }" class="card p-3 mt-2 flex-row align-items-center justify-content-between lh-1 small">
            <div class=" d-flex gap-2 align-items-center text-muted mr-auto">
              <span x-text="tag.totalFired" class="badge text-bg-primary"></span>
              <i class="bi bi-tag-fill flex-shrink-0"></i>
              <span x-text="tag.name" class="font-monospace"></span>
            </div>
            <i class="bi bi-check-circle-fill text-success"></i>
          </div>
        </template>

      </div>

      <div class="position-relative">
        <hr class="my-5">
        <span class="badge text-bg-secondary fw-semibold text-uppercase rounded-pill position-absolute" style="top: 50%; left: 50%; transform: translate(-50%, -50%);">End Tag Log</span>
      </div>

      <div class="d-flex align-items-center justify-content-center gap-2 text-center text-muted mt-4">
        <button class="btn btn-link btn-sm p-0" data-consent-action="showSettings">Open Settings Modal</button>
        <!-- / <button class="btn btn-link btn-sm p-0" data-toggle-stylesheets>Disable Stylesheets</button> -->
      </div>

    </div>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script>

</body>
</html>